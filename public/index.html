<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="msapplication-tap-highlight" content="no" />

    <title>Clong</title>

    <link rel="stylesheet" href="/assets/styles/styles.css">
</head>
<body>
    <div id="clong-main"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script src="/assets/scripts/helpers.js"></script>
    <script>
    const ws = new WebSocket(wsProtocol() + '//' + window.location.host + '/ws/client');
    const clong = document.getElementById('clong-main');
    const mc = new Hammer(clong);

    var w = 0;
    var h = 0;
    var myColor = '#fff';

    function init() {
        calcScreenSize();
        window.addEventListener('resize', (e) => {
            calcScreenSize();
        });

        // Set player color
        myColor = randomColor();
        clong.style.backgroundColor = myColor;

        // Listen for new swipes
        mc.get('swipe').set({ direction: Hammer.DIRECTION_ALL });
        mc.on('swipe', function(e) {
            const msg = {
                color: myColor,
                posX: relW(e.center.x),
                velocityX: rel(e.velocityX),
                velocityY: relH(e.velocityY),
            };

            ws.send(JSON.stringify(msg));
        });
    }

    init();
    </script>
</body>
